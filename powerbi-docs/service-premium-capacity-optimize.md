---
title: Оптимизация емкости Microsoft Power BI Premium
description: Описывает стратегии оптимизации для емкостей Power BI Premium.
author: mgblythe
ms.author: mblythe
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-admin
ms.topic: conceptual
ms.date: 04/09/2019
ms.custom: seodec18
LocalizationGroup: Premium
ms.openlocfilehash: 06712b6bcf57ca84ec03d2c7b99b32ea61ad8c71
ms.sourcegitcommit: 60dad5aa0d85db790553e537bf8ac34ee3289ba3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2019
ms.locfileid: "65565328"
---
# <a name="optimizing-premium-capacities"></a>Оптимизация емкости "премиум"

При возникновении проблем производительности с емкостью уровня "премиум", наиболее распространенный первый подход заключается в оптимизации или настройки решения для восстановления приемлемое время отклика. Основной причиной, чтобы избежать приобретения дополнительной емкости "премиум", если не оправдано.

Если требуется дополнительная емкость "премиум", существует два варианта, описанные в этой статье:

- Увеличивать емкость "премиум"
- добавить новую емкость Premium.

Наконец, тестирование заключить в этой статье, подходы и изменения размера емкости "премиум".

## <a name="best-practices"></a>Советы и рекомендации

При попытке получения оптимального использования и производительности, существуют некоторые рекомендации, включая:

- С помощью рабочих областей приложения вместо личные рабочие области.
- Разделение критически важный для бизнеса и самостоятельного бизнес-Аналитики (SSBI) на различных компонентов.

  ![Разделение критических важных для бизнеса задач и самостоятельной бизнес-аналитики на разные емкости.](media/service-premium-capacity-optimize/separate-capacities.png)

- При совместном использовании содержимого только с Power BI Pro пользователям, возможно, не нужно хранить содержимое в выделенной емкости.
- Используйте выделенные емкости заинтересован в конкретных интервал, или когда необходимы конкретные компоненты. Например с большими наборами данных или отчетов с разбиением на страницы.

### <a name="addressing-common-questions"></a>Адресация часто задаваемые вопросы

Оптимизация развертывания Power BI Premium — это сложная задача, включающие объяснение требований рабочей нагрузки, доступных ресурсов и их эффективное использование.

В этой статье рассматриваются семь часто задаваемые службе поддержки, описывающий возможные проблемы и описание и сведения о том, как определить и устранить их.

### <a name="why-is-the-capacity-slow-and-what-can-i-do"></a>Почему емкость медленная? Как решить эту проблему?

Существует множество причин замедления работы емкости Premium. Для ответа на это вопрос нам необходимы дополнительные сведения, которые помогут понять, что подразумевается под "медленная". Отчеты загружаются медленно? Или во время их загрузки происходят сбои? При использовании отчетов медленно загружаются или обновляются их визуальные элементы? Обновляются принимая больше времени чем ожидалось, или возникали?

Поняв причину проблемы, вы можете начать поиск ее решения. Ответы на следующие шесть вопросов помогут вам решить более конкретные проблемы.

### <a name="what-content-is-using-up-my-capacity"></a>Какое содержимое использует мою емкость?

Вы можете использовать приложение **Power BI Premium Capacity Metrics** для фильтрации по емкости и просмотра метрик производительности для содержимого рабочей области. Существует возможность просмотрите использование метрик и ресурсов производительности по часам за последние семь дней для всего содержимого, хранящиеся в емкости Premium. Наблюдение за часто является первым шагом при устранении неполадок существует проблема общего плана о производительности емкости "премиум".

К ключевым метрикам для мониторинга относится:

- Средняя нагрузка на ЦП и число высокой загрузки.
- Среднее значение, памяти и число высокой загрузки и использования памяти для определенных наборов данных, потоки данных и отчеты с разбивкой на страницы.
- Активных наборов данных загружен в память.
- Длительность запроса, среднее и максимальное.
- Время ожидания запроса среднее.
- Среднее набора данных и потока данных обновляются раз.

В приложении метрики емкости Power BI Premium активной памяти показывает общий объем памяти, выделяемый для отчета, не могут быть вытеснены именно тем, что в течение последних трех минут. Резкое увеличение времени ожидания обновления может быть связано с большим и (или) активным набором данных.

**Top 5 по средней длительности** диаграммы выделит первые пять наборов данных, отчеты с разбивкой на страницы и потоки данных потребления ресурсов емкости. Содержимое в первые пять списки — кандидатами для исследования и возможные оптимизации.

### <a name="why-are-reports-slow"></a>Почему отчеты выполняются медленно?

В следующих таблицах описаны возможные проблемы и способы их выявления и устранения.

#### <a name="insufficient-capacity-resources"></a>Нехватка ресурсов в емкости

| Возможные объяснения | Способы определения | Способы устранения |
| --- | --- | --- |
| Высокий уровень суммарная активная память (модели не может быть удалена, так как он используется в последние три минуты).<br><br> Время ожидания несколько высокой пиков в запросе.<br><br> Несколько высокой всплески обновления времени ожидания. | Мониторинг метрик памяти \[ [1](#endnote-1)\]и количества вытеснения \[ [2](#endnote-2)\]. | Можно уменьшить размер модели, или преобразовать в режиме DirectQuery. См. в разделе [оптимизация моделей](#optimizing-models) этой статьи.<br><br> Увеличивать емкость.<br><br> Назначение содержимого в другой емкости. |

#### <a name="inefficient-report-designs"></a>Неэффективная разработка отчетов

| Возможные объяснения | Способы определения | Способы устранения |
| --- | --- | --- |
| Страницы отчета содержат слишком много визуальных элементов (интерактивная Фильтрация может активировать хотя бы один запрос каждого визуального элемента).<br><br> Визуальные элементы получено больше данных, чем необходимо. | Просмотрите конструкций отчета.<br><br> Опрос пользователей отчетов, чтобы понять, как они взаимодействуют с отчетами.<br><br> Мониторинг метрик запроса набора данных \[ [3](#endnote-3)\]. | Перепроектирование отчеты с помощью меньшего числа визуальных элементов на одной странице. |

#### <a name="dataset-is-slow-especially-when-reports-have-previously-performed-well"></a>Набор данных работает медленно, особенно в том случае, если отчеты также ранее выполнили

| Возможные объяснения | Способы определения | Способы устранения |
| --- | --- | --- |
| Все чаще больших объемов данных импорта.<br><br> Логика вычислений сложностью или низкой производительностью, включая роли RLS.<br><br> Модель не полностью оптимизирована.<br><br> (DQ/LC) Задержка шлюза.<br><br> Медленно DQ источника времени отклика на запрос. | Просмотрите схемы модели.<br><br> Счетчики производительности шлюза. | См. в разделе [оптимизация моделей](#optimizing-models) этой статьи. |

#### <a name="high-concurrent-report-usage"></a>Высокий коэффициент параллельного использования отчетов

| Возможные объяснения | Способы определения | Способы устранения |
| --- | --- | --- |
| Время ожидания большого количества запросов.<br><br> Насыщенность ЦП.<br><br> Превышено ограничение числа подключений DQ/LC. | Отслеживать загрузку ЦП \[ [4](#endnote-4)\], времени ожидания запросов и возможность использования DQ/LC \[ [5](#endnote-5) \] метрики + длительность запроса. Если постоянно меняется, можно указать проблем параллелизма. | Увеличивать емкость, или назначьте содержимое другой емкости.<br><br> Перепроектирование отчеты с помощью меньшего числа визуальных элементов на одной странице. |

**Примечания.**    
<a name="endnote-1"></a>\[1\] среднее значение использования памяти (ГБ) и высоким потреблении памяти (ГБ).   
<a name="endnote-2"></a>\[2\] количество вытеснений из набора данных.   
<a name="endnote-3"></a>\[3\] запросы набора данных, набора данных среднее длительность запроса (мс), набор данных будут ожидать, Count и набора данных среднего времени ожидания (мс).   
<a name="endnote-4"></a>\[4\] высокий показатель использования ЦП и время ЦП с наибольшей загрузкой (за последние семь дней).   
<a name="endnote-5"></a>\[5\] DQ/LC высокий показатель использования и время DQ/LC наибольшей загрузкой (за последние семь дней).   

### <a name="why-are-reports-not-loading"></a>Почему отчеты не загружаются?

Отчеты не удалось загрузить, при Признак емкости не хватает памяти и чрезмерно жаркие. Такое происходит, когда все загруженные модели активны, и поэтому их невозможно удалить, а любые операции обновления были приостановлены или отложены. Служба Power BI попытается загрузить набор данных на протяжении 30 секунд, а пользователь получит уведомление о сбое с предложением повторить попытку в ближайшее время.

В настоящее время метрики для отслеживания сбоя загрузки отчетов отсутствуют. Вы можете определить потенциал этой проблемы, отслеживая системную память, в частности, максимальное потребление и время такого потребления. Высокий уровень вытеснения наборов данных и среднее время длительного обновления набора данных могут указывать на возникновение этой проблемы.

Если подобная проблема случается очень редко, нет необходимости уделять ей первоочередное внимание. Пользователи отчетов получают уведомление о том, что служба занята и что они должны повторить попытку в ближайшее время. Если подобная проблема случается слишком часто, ее можно решить, увеличив масштаб емкости Premium или назначив содержимое другой емкости.

Администраторы емкости (и администраторы службы Power BI) могут отслеживать метрику **неудачных запросов**, чтобы определить время возникновения проблемы. Кроме того, они могут перезапускать емкость, чтобы отменить выполнение всех операций в случае перегрузки системы.

### <a name="why-are-refreshes-not-starting-on-schedule"></a>Почему обновления не запускаются по расписанию?

Запланированное время запуска обновления не гарантируется. Напомним, что служба Power BI всегда будет отдавать приоритет интерактивным операциям, а не фоновым. Обновление — это фоновая операция, которая может выполняться при соблюдении двух условий:

- наличие достаточного объема памяти;
- количество поддерживаемых одновременных обновлений для емкости Premium не превышено.

В противном случае обновление ставится в очередь до тех пор, пока эти условия не будут выполнены.

Напомним, что для выполнения полного обновления требуется как минимум двойной объем текущей памяти набора данных. Если памяти недостаточно, выполнение обновления не начнется до тех пор, пока вытеснение модели не освободит память. Это приведет к задержке, которая будет длиться до тех пор, пока один или несколько наборов данных станут неактивными, после чего их можно будет удалить.

Напомним, что поддерживаемое количество максимальных одновременных обновлений в 1,5 раза превышает количество серверных виртуальных ядер, округленное в большую сторону.

Запланированное обновление не будет выполнено, если оно не сможет запуститься до выполнения следующего запланированного обновления. Прежде чем произойдет сбой, будет предпринято три попытки выполнить обновление по требованию, запускаемое вручную из пользовательского интерфейса.

Администраторы емкости (и администраторы службы Power BI) могут отслеживать метрику **среднего времени ожидания обновления (в минутах)** , чтобы определить среднюю задержку между запланированным временем и временем начала операции.

Хотя это не является приоритетной административной задачей, влияющей на своевременное обновление данных, убедитесь в наличии достаточного объема памяти. Для этого может потребоваться изоляция наборов данных в емкости с достаточным количеством ресурсов. Это также возможно, что администраторы могут обратиться к владельцы наборов данных, чтобы управлять временем или сокращения времени обновления данных по расписанию, чтобы свести к минимуму конфликты. Обратите внимание на то, что он не администратор для просмотра очереди обновления, или для получения набора данных расписания.

### <a name="why-are-refreshes-slow"></a>Почему обновления выполняются медленно?

Обновление может быть медленным или восприниматься как медленное (как указано в предыдущем вопросе).

Если обновление на самом деле выполняется медленно, это может быть обусловлено рядом следующих причин:

- Недостаточно ресурсов ЦП (обновление может быть очень интенсивно использующие ЦП).
- Недостаточно памяти, что приостановка обновления (для которого требуется обновление, чтобы начать заново, если выполняются условия подходящую отключены).
- Емкости не причинам, включая скорость ответа системы источника данных, задержка в сети, недопустимые разрешения или пропускная способность шлюза.
- Том данных — веская причина для настройки добавочное обновление, как описано ниже.

Администраторы емкости (и администраторы службы Power BI) могут отслеживать метрику **средней длительности обновления (в минутах)** , чтобы определить тест производительности для сравнения по времени, и метрики **среднего времени ожидания обновления (в минутах)** , чтобы определить среднюю задержку между запланированным временем и временем начала операции.

Добавочное обновление может значительно сократить длительность обновления данных, особенно для больших таблиц моделей. С добавочным обновлением связаны четыре преимущества:

- **Обновления выполняются быстрее** — только часть таблицы требуется загрузка, уменьшая использования ЦП и памяти и параллелизма может быть выше, при обновлении нескольких секций.
- **Обновляется только в том случае, если требуется** -политики добавочного обновления можно настроить для загрузки только после изменения данных.
- **Обновляет более надежны,** -короче работающей подключения к системам volatile источник данных более надежны, отключения.
- **Модели остаются trim** -политики добавочного обновления можно настроить таким образом, чтобы автоматически удалять журнал за скользящее окно времени.

Дополнительные сведения см. в разделе [добавочное обновление в Power BI Premium](service-premium-incremental-refresh.md).

### <a name="why-are-data-refreshes-not-completing"></a>Почему обновления данных не завершаются?

Если обновление данных запускается, но не завершается, это может быть обусловлено рядом следующих причин:

- Недостаточно памяти, даже если имеется только одна модель в емкости Premium, т. е. модель имеет очень большой размер.
- Сократить использование емкости не, включая отключение системы источника данных, недопустимые разрешения или ошибка шлюза.

Администраторы емкости (и администраторы службы Power BI) могут отслеживать метрику **ошибок обновления по причине нехватки памяти**, чтобы определить время возникновения проблемы.

## <a name="optimizing-models"></a>Оптимизация моделей

Оптимальная разработка модели позволяет предоставить эффективное и масштабируемое решение. Однако это выходит за рамки этой статьи, чтобы предоставить подробные сведения. Вместо этого в данном разделе описаны основные области, на которые стоит обратить внимание при оптимизации моделей.

### <a name="optimizing-power-bi-hosted-models"></a>Оптимизация Power BI размещенных моделей

Оптимизация моделей, размещенного в емкости Premium может осуществляться на уровнях источники данных и модели.

Рассмотрим возможности оптимизации для модели импорта:

![Возможности оптимизации для модели импорта](media/service-premium-capacity-optimize/import-model-optimizations.png)

На уровне источника данных:

- Реляционные источники данных можно оптимизировать для обеспечения наиболее быстрый возможные обновления, предварительно интеграции данных, применение соответствующих индексов, определение секции таблицы, выравнивание для добавочного обновления периодов и материализации вычисления (вместо вычисления модель таблиц и столбцов) или добавления логики вычислений с представлениями.
- Источники нереляционные данные можно предварительно интегрировано с реляционными хранилищами.
- Убедитесь, что шлюзы имеют достаточно ресурсов, предпочтительно на выделенных машинах, достаточная пропускная способность сети и в непосредственной близости к источникам данных.

На уровне модели:

- Схемы запросов Power Query могут минимизировать или удалить сложные преобразования, в первую очередь те, которые объединяют различные источники данных (для хранилищ данных это процесс выполняется на этапе извлечения, преобразования и загрузки). Кроме того заданы обеспечение уровни конфиденциальности, соответствующий источник данных, это поможет избежать необходимости Power BI, чтобы загрузить полный результаты для получения объединенного результата для всех запросов.
- Структура модели определяет данные для загрузки и напрямую влияет на размер модели. Ее можно разработать таким образом, чтобы избежать загрузки ненужных данных путем удаления столбцов и строк (особенно исторических данных) или загрузки сводных данных (за счет загрузки подробных данных). Достигнуть значительного уменьшения размера можно за счет удаления столбцов с большим количеством элементов (особенно текстовых столбцов), которые не очень эффективно сохраняются или сжимаются.
- Производительность запросов модели можно улучшить за счет настройки однонаправленных отношений, если нет веских причин для настройки двунаправленной фильтрации. Рассмотрите также возможность использования [CROSSFILTER](https://docs.microsoft.com/dax/crossfilter-function) функцию вместо двусторонней фильтрации.
- Таблицы агрегирования могут обеспечить быстрые ответы на запросы за счет загрузки предварительно суммированных данных, однако это увеличит размер модели и приведет к увеличению времени обновления. Как правило, таблицы агрегирования должны быть зарезервированы для очень больших моделей или составных моделей.
- Вычисляемые таблицы и столбцы увеличивают размер модели и время обновления. Как правило уменьшение размера хранилища и сокращение времени обновления достигается при материализованные данные или вычисляется в источнике данных. Если это невозможно, использование настраиваемых столбцов Power Query может улучшить сжатие хранилища.
- Вам может представиться возможность настроить выражения DAX для мер и правил RLS, к примеру переписав логику, чтобы избежать ресурсоемких формул.
- Добавочное обновление может значительно сократить время обновления и уменьшить загрузку памяти и ЦП. Кроме того, добавочное обновление можно настроить для удаления исторических данных, сохраняя размеры модели усеченными.
- При наличии различных и противоречивых шаблонов запросов вы можете изменить модель, разделив ее на две модели. Например, некоторые отчеты представляют статистические выражения высокого уровня по всей истории и могут выдерживать задержку длительностью 24 часа. Другие отчеты фокусируются на актуальных данных и требуют доступ к отдельным транзакциям. Вместо того чтобы разрабатывать одну модель для удовлетворения требований всех отчетов, создайте две модели, оптимизированные для каждого требования.

Рассмотрим возможности оптимизации для модели DirectQuery. Как модель выдает запросы базового источника данных, оптимизации источника данных крайне важен для доставки запросах быстрые модели.

 ![Возможности оптимизации для модели DirectQuery](media/service-premium-capacity-optimize/direct-query-model-optimizations.png)

На уровне источника данных:

- Источник данных можно оптимизировать, чтобы обеспечить быстрый возможных запроса с предварительно интеграции данных (который не поддерживается на уровне модели), применение соответствующих индексов, определения секций таблицы, материализация сводные данные, (с индексированными представлениями), и минимизировать объем вычислений. Получения наилучших результатов достигается, когда передаваемые запросы нужны только фильтрации и выполнение внутренних соединений между индексированных таблиц или представлений.
- Убедитесь, что шлюзы имеют достаточно ресурсов, предпочтительно на выделенных машинах, достаточная пропускная способность сети и в непосредственной близости к источнику данных.

На уровне модели:

- Power запросов обращения к макеты предпочтительно следует применить нет преобразования - в противном случае пытаться разместить минимальные преобразования является абсолютным.
- Производительность запросов модели можно улучшить за счет настройки однонаправленных отношений, если нет веских причин для настройки двунаправленной фильтрации. Кроме того, моделировать отношения должны предполагается (в этом случае), применяется ссылочная целостность и приведет к запросов источника данных, с помощью эффективнее внутренних соединений (вместо внешних соединений).
- Избегайте создания настраиваемых столбцов запроса Power Query или вычисляемый столбец модели — материализовать их в источник данных, если это возможно.
- Может существовать возможность настраивать выражения DAX для мер и правила RLS, возможно перезаписи логики, чтобы избежать ресурсоемких формулы.

Рассмотрим возможности оптимизации для составной модели. Напомним, что составная модель допускает сочетание таблиц импорта и DirectQuery.

![Возможностях оптимизации для составной модели](media/service-premium-capacity-optimize/composite-model-optimizations.png)

- Как правило оптимизации для импорта и DirectQuery моделей применяются к составной модели таблицы, которые используют эти режимы хранения.
- Обеспечить сбалансированную разработку можно путем настройки таблиц измерений (представляющих собой бизнес-сущности) в качестве двойного режима хранения и таблиц фактов (часто больших таблиц, представляющих собой рабочие факты) в качестве режима хранения DirectQuery. Режим хранения данных с двумя означает импорта и DirectQuery режимы хранения и это позволяет службе Power BI определить наиболее эффективный режим хранения для использования при создании собственного запроса для сквозной.
- Убедитесь, что шлюзы содержат достаточное количество ресурсов, предпочтительно на выделенных компьютерах с достаточной пропускной способностью и в непосредственной близости от источников данных.
- Таблицы агрегирования, для которых настроен режим импорта, могут значительно повысить производительность запросов при суммировании таблиц фактов в режиме хранения DirectQuery. При этом таблицы агрегирования увеличат размер модели и время обновления. Часто это является приемлемым компромиссом для более быстрых запросов.

### <a name="optimizing-externally-hosted-models"></a>Оптимизация извне размещенных моделей

Множество возможностей оптимизации подробно [оптимизация Power BI размещенных моделей](#optimizing-power-bi-hosted-models) раздел также относится к моделям, разработанные с помощью служб Azure Analysis Services и SQL Server Analysis Services. Очевидными исключениями являются некоторые функции, которые в настоящее время не поддерживаются, а также составные модели и таблицы агрегирования.

Рассматривая внешние наборы данных, необходимо уделить дополнительное внимание размещению базы данных по отношению к службе Power BI. Для служб Azure Analysis Services это означает создание ресурса Azure в регионе клиента Power BI (домашнем регионе). Для служб SQL Server Analysis Services (для IaaS) это означает размещение виртуальной машины в одном регионе, а для локальных служб — обеспечение эффективной настройки шлюза.

Кроме того, интересно отметить, что базы данных Azure Analysis Services и табличные базы данных SQL Server Analysis Services требуют, чтобы их модели были полностью загружены в память и чтобы они всегда оставались там для поддержки выполнения запросов. Как и в случае службы Power BI, для выполнения обновления необходим достаточный объем памяти, если модель должна оставаться подключенной во время обновления. В отличие от службы Power BI, в рамках решения Power BI Premium не существует концепции, согласно которой модели автоматически устаревают в памяти и вне ее в зависимости от использования. Таким образом, Power BI Premium предлагает более эффективный подход для максимизации запросов к моделям с меньшей загрузкой памяти.

## <a name="capacity-planning"></a>Планирование мощности

Размер емкости Premium определяет объем доступной памяти и ресурсы процессора, а также пределы, устанавливаемые для емкости. Количество емкостей Premium также принимается во внимание, так как создание нескольких емкостей Premium может изолировать рабочие нагрузки друг от друга. Обратите внимание, что объем хранилища составляет 100 ТБ на узел емкости, и этого, вероятно, будет более чем достаточно для любой рабочей нагрузки.

Определение размера и количества емкостей Premium может быть сложной задачей, особенно для начальных емкостей. При определении размера емкости в первую очередь нужно разобраться со средней рабочей нагрузкой, представляющей ожидаемое ежедневное использование. Важно понимать, что не все рабочие нагрузки равны. Например, с одной стороны, ситуацию со 100 пользователями, одновременно получающими доступ к одной странице отчета, содержащей один визуальный элемент, легко реализовать. Но с другой стороны, в ситуации со 100 пользователями, одновременно получающими доступ к 100 различным отчетам, каждый из которых содержит 100 визуальных элементов на странице отчета, к ресурсам емкости будут предъявлены совершенно другие требования.

Поэтому администраторам емкости необходимо учитывать множество факторов, специфичных для вашей среды, содержимого и ожидаемого использования. Основная задача — максимизировать потребление емкости, обеспечивая согласованное время запросов, приемлемое время ожидания и частоту вытеснения. К упомянутым выше факторам относятся:

- **Размер и данных характеристики модели** -импорта модели должны быть полностью загружены в память, чтобы разрешить выполнение запросов или обновление. Наборам данных активных подключений и DQ может потребоваться значительная загруженность процессора, а также, возможно, значительный объем памяти для оценки сложных мер или правил RLS. Объем памяти и размер процессора, а также пропускная способность запросов активных подключений и DQ ограничены размером емкости.
- **Одновременных активных моделей** -параллельных запросов импорта различных моделей будет доставлять рекомендации скорость реагирования и производительность при они остаются в памяти. Для размещения всех моделей с большим количеством запросов необходим достаточный объем памяти. Кроме того, для их обновления потребуется дополнительная память.
- **Импорт обновления модели** -тип обновления (полное или добавочное), длительность и сложности запросы Power Query и логики вычисляемого столбца может повлиять на в памяти и особенно процессора. Одновременные обновления ограничены размером емкости (в 1,5 раза больше количества серверных виртуальных ядер, округленного в большую сторону).
- **Число одновременных запросов** -множества параллельных запросов может привести в отвечать на запросы выдает сообщение, если процессор или LC/DQ подключений превышает к пределу пропускной способности. В первую очередь это касается страниц отчетов, которые содержат большое количество визуальных элементов.
- **Потоки данных и разбиением** -емкости можно настроить для поддержки потоков данных и отчеты с разбивкой на страницы, с каждому из которых требуется можно настроить максимальный процент ресурсов памяти. Память выделяется динамически, чтобы потоки данных, но статически выделяется на отчеты с разбивкой на страницы.

В дополнение к этим факторам администраторы емкости могут рассмотреть возможность создания нескольких емкостей. Большое количество емкостей позволяет изолировать рабочие нагрузки. Их можно настроить для обеспечения гарантированных ресурсов приоритетным рабочим нагрузкам. Например, можно создать две емкости, чтобы отделить критически важные для бизнеса рабочие нагрузки от рабочих нагрузок самостоятельной бизнес-аналитики. Критически важную для бизнеса емкость можно использовать для изоляции больших корпоративных моделей, обеспечивая их гарантированными ресурсами. При этом доступ для создания предоставляется только ИТ-отделу. Емкость самостоятельной бизнес-аналитики можно использовать для размещения возрастающего количества небольших моделей с доступом, предоставляемым бизнес-аналитикам. Время от времени емкость самостоятельной бизнес-аналитики может испытывать допустимые задержки в выполнении запросов или обновлений.

Со временем администраторы емкости смогут балансировать рабочие области между емкостями, перемещая содержимое между рабочими областями или рабочие области между емкостями, а также увеличивая или уменьшая масштаб емкости. В общем случае модели большего размера узлов вы вертикального масштабирования, а также для повышения уровня параллелизма в случае горизонтального масштабирования.

Напомним, что при приобретении лицензии для клиента предоставляются виртуальные ядра. Приобретение подписки **P3** позволит создать от одной до четырех емкостей Premium, то есть 1 в P3, 2 в P2 или 4 в P1. Кроме того, перед преобразованием емкости P2 в емкость P3 можно разделить виртуальные ядра для создания двух емкостей P1.

## <a name="testing-approaches"></a>Тестирование подходы

После определения размера емкости можно выполнить тестирование путем создания контролируемой среды. Практическим и экономичным вариантом является создание емкости Azure (SKU A) с учетом того, что размер емкости P1 соответствует размеру емкости A4, а размер емкостей P2 и P3 соответствуют размеру емкостей A5 и A6. Емкости Azure можно создавать достаточно быстро. Они оплачиваются на почасовой основе. Таким образом, после завершения тестирования их можно легко удалить, чтобы остановить накопление издержек.

Содержимое теста можно добавить в рабочие области, созданные в емкости Azure, а затем отдельные пользователи могут запускать отчеты для создания реалистичной и репрезентативной рабочей нагрузки запросов. В случае использования моделей импорта необходимо выполнить обновление каждой модели. Затем с помощью инструментов мониторинга можно просмотреть все метрики, чтобы получить сведения о потреблении ресурсов.

Очень важно, что тесты можно повторить. Тесты должны выполняться несколько раз, и каждый раз они должны иметь примерно одинаковый результат. Среднее значение по этим результатам можно использовать для экстраполяции и оценки рабочей нагрузки в реальных рабочих условиях.

Чтобы создать нагрузочный тест, разработайте приложение нагрузочного тестирования для имитации реалистичной рабочей нагрузки. Особенности того, как добиться этого выходят за рамки данной статьи. Для получения дополнительных сведений, включая пример кода, см. [нагрузочных тестов для приложений Power BI с помощью нагрузочного теста Visual Studio](https://blogs.msdn.microsoft.com/charles_sterling/2018/04/04/webinar-load-testing-power-bi-applications-with-visual-studio-load-test/) веб-семинар.

## <a name="acknowledgements"></a>Подтверждения

Эта статья написана, Питер Майерс, MVP платформы данных и независимых экспертом по бизнес-Аналитики с [побитового решения](https://www.bitwisesolutions.com.au/).

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Сценарии емкости "премиум"](service-premium-capacity-scenarios.md)   
  
Появились дополнительные вопросы? [Попробуйте задать вопрос в сообществе Power BI.](https://community.powerbi.com/)

||||||